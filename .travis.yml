sudo: false
language: c
addons:
  apt:
    packages:
    - libgmp-dev
before_install:
- mkdir -p ~/.local/bin
- export PATH=$HOME/.local/bin:$PATH
- travis_retry curl -L https://www.stackage.org/stack/linux-x86_64 | tar xz --wildcards
  --strip-components=1 -C ~/.local/bin '*/stack'

script:
- stack --no-terminal --install-ghc build
- stack exec zyghost-com clean
- stack exec zyghost-com build

cache:
  directories:
  - "$HOME/.stack"

deploy:
  provider: s3
  access_key_id: AKIAIK7QVDPAZR2VYUSQ
  secret_access_key:
    secure: LcGRI/ZY6tdsU/KUBvPErmN4tUTXJZwJlYePuijSAdBrnUuT08bQr5rC7RKzyMxnXvdAKMNMdd/n599xKvUCcLZ3j1q0+l7sdvMIZ0SGgGYamoSZjKSR8zTDz5AtDlqT6SsZKh2sEHKrF4NTQ7A+UOW4Xq0PAKGAJYVVJOYOXeJJIBTr/ZAaX1HDib4VLWdZkUwPgQohD0jgVYtGfubrT41j2SBKUhVn9Dmfq2lyrmTRIA9j+8mUkv1ney7ARBnuSUo7kPemoBaTeGHX/KC/wA8Dwx1Gzus0kTo7/PJwmGheCMXXm1by5VIadl6VcsXdnyzo16m61TI5yfTVcbZVN0xGFgCFyiR5YrM6C5ZJVJZ5vd1KUA9jGedYFa9QjhTdFa3xzDEwsNGmqS5+eJyRe2ntXP5yEjlF2ABiojACcNkykGPPBwdxz0BnXgW2BihpMfaNCp9vagOyOURZ9Sl+vocIntaOUdbqOAf5LaTwahfFHaUzhh2s00Xkda78HiM9xOU8x0DRI5wWS9ZIq1AJp5BjcI2kDYu8QuxekHF3KJ3Td3vY9FMjo5UnlfLcaflyAy5/X7z3FHR/cTbirB32D1FbzozIf6Q340VqrxgusvQm063ztiC+WAiY6DDxOYyqf+pb5wnzjjoP794ZkC7asCPf/MqnjK9G1T/xwUrcv2k=
  bucket: zyghost.com
  local-dir: _site
  acl: public_read
  on:
    repo: schell/zyghost-com
